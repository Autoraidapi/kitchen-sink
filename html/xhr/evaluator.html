<!DOCTYPE html>
<html lang="en" class="bg-dark">
<head>
  <meta charset="UTF-8">
  <title>CodePen - Javascript REPL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<script src="https://codepen.io/RJLeyra/pen/bLbLLa.js"></script>

<style>
.prompt {
  list-style-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjZweCIgaGVpZ2h0PSI4cHgiIHZpZXdCb3g9IjAgMCA2IDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuNi4xICgyNjMxMykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+cGF0aDM2OTE8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMSwxIEw0LjUsNC4yNSBMMSw3LjUiIGlkPSJwYXRoMzY5MSIgc3Ryb2tlPSIjMzY3Q0YxIiBzdHJva2Utd2lkdGg9IjEuNSI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=);
}
.output {
  list-style-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjhweCIgaGVpZ2h0PSI4cHgiIHZpZXdCb3g9IjAgMCA4IDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuNi4xICgyNjMxMykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+R3JvdXA8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMDAwMDAwLCAwLjAwMDAwMCkiPgogICAgICAgICAgICA8cGF0aCBkPSJNNSw0IEM1LDQuNTUgNS40NSw1IDYsNSBDNi41NSw1IDcsNC41NSA3LDQgQzcsMy40NSA2LjU1LDMgNiwzIEM1LjQ1LDMgNSwzLjQ1IDUsNCIgaWQ9InBhdGgzNjk1IiBmaWxsPSIjQkFCQUJBIj48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik00LjI1LDAuNzUgTDAuNzUsNCBMNC4yNSw3LjI1IiBpZD0icGF0aDM2OTciIHN0cm9rZT0iI0JBQkFCQSIgc3Ryb2tlLXdpZHRoPSIxLjUiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==);
}
.error {
  list-style-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjEwcHgiIGhlaWdodD0iMTBweCIgdmlld0JveD0iMCAwIDEwIDEwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCAzLjYuMSAoMjYzMTMpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPgogICAgPHRpdGxlPkdyb3VwPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+PC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwIj4KICAgICAgICAgICAgPHBhdGggZD0iTTUsOS42NCBDNy41Niw5LjY0IDkuNjQsNy41NiA5LjY0LDUgQzkuNjQsMi40NCA3LjU2LDAuMzYgNSwwLjM2IEMyLjQ0LDAuMzYgMC4zNiwyLjQ0IDAuMzYsNSBDMC4zNiw3LjU2IDIuNDQsOS42NCA1LDkuNjQgWiIgaWQ9InBhdGgzNzAxIiBmaWxsPSIjRUIzOTQxIj48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0zLDMgTDcsNyIgaWQ9InBhdGgzNzAzIiBzdHJva2U9IiNGRkZGRkYiIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTcsMyBMMyw3IiBpZD0icGF0aDM3MDUiIHN0cm9rZT0iI0ZGRkZGRiIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+);
}
.info {
  list-style-image : url(https://assets.codepen.io/1674766/info.svg);
}

.disabled {
  opacity : 0.5;
  list-style-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjhweCIgaGVpZ2h0PSI4cHgiIHZpZXdCb3g9IjAgMCA4IDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuNi4xICgyNjMxMykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+R3JvdXA8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz48L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEuMDAwMDAwLCAwLjAwMDAwMCkiPgogICAgICAgICAgICA8cGF0aCBkPSJNNSw0IEM1LDQuNTUgNS40NSw1IDYsNSBDNi41NSw1IDcsNC41NSA3LDQgQzcsMy40NSA2LjU1LDMgNiwzIEM1LjQ1LDMgNSwzLjQ1IDUsNCIgaWQ9InBhdGgzNjk1IiBmaWxsPSIjQkFCQUJBIj48L3BhdGg+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik00LjI1LDAuNzUgTDAuNzUsNCBMNC4yNSw3LjI1IiBpZD0icGF0aDM2OTciIHN0cm9rZT0iI0JBQkFCQSIgc3Ryb2tlLXdpZHRoPSIxLjUiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==);
}

*,
::after,
::before {
  box-sizing: border-box;
  font-size: 16px;
  font-family: monospace, sans-serif;
  text-rendering: geometricprecision;
  color: #ccc;
}
html {
  -text-size-adjust: 100%;
  -tap-highlight-color: transparent;
}
body {
  margin: 0;
  text-align: left;
  background-color : #333;
}
ul {
  margin: 1px;
  padding-left: 1.25em;
  cursor: pointer;
  border: 1px solid RGBA(0, 0, 0, 0.15);
}
ul:hover {
  background-color: rgba(0, 0, 0, 0.15);
}
input {
  display: inline-block;
  background: 0 0;
  border: none;
  outline: 0;
  color: currentcolor;
  caret-color: currentcolor;
  width: 100%;
}
li {
  word-break: break-all;
  word-wrap: break-word;
  white-space: pre-wrap;
}
svg {
  filter: invert(100%);
}
.fade {
  opacity: 0.5;
}
.undefined {
  color: #AAA;
}

.string {
  color: steelblue;
}
.object {
  color: #DDD;
}
.function {
  color: #EEE;
}
.date {
  color: #006064;
}
.boolean {
  color:  #BF360C;
}
.number {
  color: #01579B;
}
.error {
  color: #d50000;
}
.syntax-error {
  color: #dc143c;
}
.reference-error {
  color: #c62828;
}
.eval-error {
  color: #dc143c;
}
.range-error {
  color: red;
}
.type-error {
  color: maroon;
}

.fade, 
.fade:after  { opacity : 0; }
.fade:before { opacity : 1;	}
.show:before { opacity : 0; }
.show:after  { opacity : 1; }
#main {
  will-change : opacity;
  transition : all .5s;
  
  height : 100vh;
  max-width: 600px;

  margin: 0 auto 0 auto;
  
  display: block;
  
  overflow: auto;

  border-radius: 1px;
  border: 1px solid RGBA(0, 0, 0, 0.15);
  
  background-image: url(data:image/bmp;base64,Qk06AAAAAAAAADYAAAAoAAAAAQAAAAEAAAABABgAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAISEhAA==);
  
}

#main::-webkit-scrollbar,
#main::-webkit-scrollbar-button,
#main::-webkit-scrollbar-track,
#main::-webkit-scrollbar-track-piece,
#main::-webkit-scrollbar-thumb,
#main::-webkit-scrollbar-corner,
#main::-webkit-resizer {
  background: transparent;
}

#main::-webkit-scrollbar {
  width: 7px;
  height: 7px;
  -webkit-border-radius: 4px;
  border-radius: 4px;
}

#main::-webkit-scrollbar-track-piece {
  -webkit-border-radius: 5px;
  border-radius: 5px;
}
#main::-webkit-scrollbar-thumb {
  background: #4f4f4f;
  border-radius: 5px;
}
#main::-webkit-scrollbar-button {
  width: 0;
  height: 0;
}
</style>

  
  
  
  

</head>

<body translate="no" >
  <main id="main" class="show">
  <article>
    <section></section>
  </article>
</main>

<script type="text/js-worker" id="js-worker"> 
(function (global) { 
  function escaped(value) { return String(value) .replace(/\\"/g, '"') .replace(/&/g, "&amp;") .replace(/"/g, "&quot;") .replace(/'/g, "&#39;") .replace(/</g, "&lt;") .replace(/>/g, "&gt;"); };
  function toSource(func) { if (func != null) { try { return Function.prototype.toString.call(func); } catch (e) {} try { return func + ""; } catch (e) {} } return ""; };
  function isFunction(obj) { return !!(obj && obj.constructor && obj.call && obj.apply); };
  function isRegExp(obj) { return !!( obj && obj.test && obj.exec && (obj.ignoreCase || obj.ignoreCase === false) ); };
  function isDate(obj) { return !!(obj && obj.getTimezoneOffset && obj.setUTCFullYear); };
  function isObject(obj) { return obj === Object(obj); };
  function isString(obj) { return !!(obj === "" || (obj && obj.charCodeAt && obj.substr)); };
  function isBoolean(obj) { return obj === true || obj === false; };
  function isNumber(obj) { return !!(obj === 0 || (obj && obj.toExponential && obj.toFixed)); };
  function isNull(obj) { return obj === null; };
  function isUndefined(obj) { return obj === void 0; };
  
	function span(options) {
    options = options || {};
    const prefix = '<span class="';
    const suffix = '">';
    const tail = "</span>";
    return prefix
      .concat(options.class)
      .concat(suffix)
      .concat(options.value)
      .concat(tail);
  };
	
  function Message(val,type) {
    this.value = val;
    this.type=type;
  }; 
	
  function evaluator(string) {
    var result, type;
    try {
      result = eval.call(this, string);
      if (isFunction(result)) { result = span({ class: "function", value: toSource(result) });  type = 'output'; } 
      else if (isRegExp(result)) { result = span({ class: "regexp", value: new RegExp(result).toString() });type = 'output';  } 
      else if (isDate(result)) { result = span({ class: "date", value: "".concat(result, "") });type = 'output';  } 
      else if (isObject(result)) { result = span({ class: "object", value: "".concat(result, "") });type = 'output';  } 
      else if (isString(result)) { result = span({ class: "string", value: "".concat(result, "") });type = 'output';  } 
      else if (isNumber(result)) { result = span({ class: "number", value: "".concat(result, "") });type = 'output'; }
      else if (isBoolean(result)) { result = span({ class: "boolean", value: "".concat(result, "") });type = 'output';  } 
      else if (isUndefined(result)) { result = span({ class: "undefined", value: "".concat(result, "") });type = 'output';  } 
      else if (isNull(result)) { result = span({ class: "null", value: "".concat(result, "") });type = 'output';  }
    } 
    catch (er) {
      if (er instanceof TypeError) { result = span({ class: "type-error", value: "[[ Type ".concat("]] ", er.message) }).concat(er.message);type = 'error';  } 
      else if (er instanceof SyntaxError) { result = span({ class: "syntax-error", value: "[[ Syntax ".concat("]] ") }).concat(er.message);type = 'error';  } 
      else if (er instanceof ReferenceError) { result = span({ class: "reference-error", value: "[[ Reference ".concat("]] ") }).concat(er.message);type = 'error';  } 
      else if (er instanceof RangeError) { result = span({ class: "range-error", value: "[[ Range ".concat("]] ") }).concat(er.message);type = 'error';  } 
      else if (er instanceof EvalError) { result = span({ class: "eval-error", value: "[[ Eval ".concat("]] ") }).concat(er.message);type = 'error';  } 
      else { result = escaped(er.stack);type = 'error';  }
    } 
    finally {
      return new Message(result,type);
    }
  };
  if (typeof global !== "undefined") { global.evaluator = evaluator; };
})(this);
(function(){ self.onmessage = function (event) {  return postMessage(evaluator(event.data));  };  })();
</script>
  
  <script src='https://assets.codepen.io/1674766/localforage.min.js'></script>
	<script src='https://assets.codepen.io/1674766/promise.js'></script>
  
      <script id="rendered-js" >
function on(element, event, listener) {
  return element.addEventListener(event, listener, false);
}

function element(target, element, options) {
  options = (options || {});
  const node = document.createElement(element);
  if (options.class) {
    node.className = options.class;
  }
  if (options.text) {
    node.appendChild(document.createTextNode(options.text));
  } else if (options.html) {
    node.innerHTML = options.html;
  }
  return target.appendChild(node);
}


function View(){
  
  this.$main = document.getElementById('main');
  this.$script = document.getElementById('js-worker');
  
  this.fragment = new DocumentFragment();
  this.blob = new Blob([this.$script.textContent], { type : 'text/javascript' });
  this.worker = new Worker(URL.createObjectURL(this.blob));
  
  on(this.worker, 'message', function(event){
    switch(event.data.type){
      case 'output' : this.output(event.data.value); break;
      case 'error' : this.error(event.data.value); break;        
    }  
  }, false);

};

View.prototype = {
  
  input : function(){
    element(this.fragment, "input", {});
    this.main.appendChild(this.fragment);
  },
  
  output : function(string){
    element(this.fragment, 'code', { html : string });
    this.main.appendChild(this.fragment);
  },
  
  error : function(string){
    element(this.fragment, 'code', { html : string });
    this.main.appendChild(this.fragment);    
  },

  disable : function(event){
    event.target.disabled = true;
    event.target.classList.add('disabled');
  },
  
  handler : function(event){
    const key = event.which;
    const value = event.target.value;    
    if(key === 13 && value === 'clear'){ this.disable(); }
    else {
      switch(key){
        case 13 : this.worker.postMessage(value); break;
      }
    }    
  }
  
};

const main = document.getElementById("main");
const fragment = new DocumentFragment();
const script =  document.getElementById('js-worker').textContent;    
const blob = new Blob([script], { type : 'text/javascript' });
const worker = new Worker(URL.createObjectURL(blob));

var parent, child, io;


function input() {
  parent = element(fragment, "ul", { class: "prompt" });
  child = element(parent, "li", { class: "list" });
  io = element(child, "input");
  on(io, "keyup", handler);
  main.appendChild(fragment);
  if (document.querySelectorAll("input").length > 1) {
    io.focus();
  }
}

function disable(event) {
  event.target.disabled = true;
  event.target.style.opacity = 0.5;
}

function handler(event) {
  const key = event.which;
  const value = event.target.value;
  switch (key) {  
    case 13 : disable(event); worker.postMessage(value); break;    
  }
}

function output(string, type) {
  parent = element(fragment, "ul", { class : type });
  child = element(parent, "li", { class: "list" });
  io = element(child, "pre", { html: string });
  main.appendChild(fragment);
  input();
}

on(worker, 'message', function(event){
  output(event.data.value, event.data.type);
});

setTimeout(input, 1);
    </script>

  

</body>

</html>
 
